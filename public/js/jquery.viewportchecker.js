!function($){$.fn.viewportChecker=function(useroptions){var options={classToAdd:"visible",classToRemove:"invisible",classToAddForFullView:"full-visible",removeClassAfterAnimation:!1,offset:100,repeat:!1,invertBottomOffset:!0,callbackFunction:function(elem,action){},scrollHorizontal:!1,scrollBox:window},$elem=($.extend(options,useroptions),this),boxSize={height:$(options.scrollBox).height(),width:$(options.scrollBox).width()};return this.checkElements=function(){var viewportStart,viewportEnd=options.scrollHorizontal?(viewportStart=Math.max($("html").scrollLeft(),$("body").scrollLeft(),$(window).scrollLeft()))+boxSize.width:(viewportStart=Math.max($("html").scrollTop(),$("body").scrollTop(),$(window).scrollTop()))+boxSize.height;$elem.each(function(){var rawEnd,elemStart,elemEnd,$obj=$(this),objOptions={},attrOptions={};$obj.data("vp-add-class")&&(attrOptions.classToAdd=$obj.data("vp-add-class")),$obj.data("vp-remove-class")&&(attrOptions.classToRemove=$obj.data("vp-remove-class")),$obj.data("vp-add-class-full-view")&&(attrOptions.classToAddForFullView=$obj.data("vp-add-class-full-view")),$obj.data("vp-keep-add-class")&&(attrOptions.removeClassAfterAnimation=$obj.data("vp-remove-after-animation")),$obj.data("vp-offset")&&(attrOptions.offset=$obj.data("vp-offset")),$obj.data("vp-repeat")&&(attrOptions.repeat=$obj.data("vp-repeat")),$obj.data("vp-scrollHorizontal")&&(attrOptions.scrollHorizontal=$obj.data("vp-scrollHorizontal")),$obj.data("vp-invertBottomOffset")&&(attrOptions.scrollHorizontal=$obj.data("vp-invertBottomOffset")),$.extend(objOptions,options),$.extend(objOptions,attrOptions),$obj.data("vp-animated")&&!objOptions.repeat||(0<String(objOptions.offset).indexOf("%")&&(objOptions.offset=parseInt(objOptions.offset)/100*boxSize.height),attrOptions=objOptions.scrollHorizontal?$obj.offset().left:$obj.offset().top,rawEnd=objOptions.scrollHorizontal?attrOptions+$obj.width():attrOptions+$obj.height(),elemStart=Math.round(attrOptions)+objOptions.offset,elemEnd=objOptions.scrollHorizontal?elemStart+$obj.width():elemStart+$obj.height(),objOptions.invertBottomOffset&&(elemEnd-=2*objOptions.offset),elemStart<viewportEnd&&viewportStart<elemEnd?($obj.removeClass(objOptions.classToRemove),$obj.addClass(objOptions.classToAdd),objOptions.callbackFunction($obj,"add"),rawEnd<=viewportEnd&&viewportStart<=attrOptions?$obj.addClass(objOptions.classToAddForFullView):$obj.removeClass(objOptions.classToAddForFullView),$obj.data("vp-animated",!0),objOptions.removeClassAfterAnimation&&$obj.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$obj.removeClass(objOptions.classToAdd)})):$obj.hasClass(objOptions.classToAdd)&&objOptions.repeat&&($obj.removeClass(objOptions.classToAdd+" "+objOptions.classToAddForFullView),objOptions.callbackFunction($obj,"remove"),$obj.data("vp-animated",!1)))})},("ontouchstart"in window||"onmsgesturechange"in window)&&$(document).bind("touchmove MSPointerMove pointermove",this.checkElements),$(options.scrollBox).bind("load scroll",this.checkElements),$(window).resize(function(e){boxSize={height:$(options.scrollBox).height(),width:$(options.scrollBox).width()},$elem.checkElements()}),this.checkElements(),this}}(jQuery);
